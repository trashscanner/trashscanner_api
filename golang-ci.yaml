version: 2

run:
  timeout: 5m
  tests: false  # Не проверяем тестовые файлы
  skip-dirs:
    - vendor
    - node_modules
    - docs  # Исключаем сгенерированную Swagger документацию
  skip-files:
    - ".*\\.pb\\.go$"
    - ".*_test\\.go$"  # Явно исключаем тестовые файлы
  go: '1.24'
  concurrency: 4
  modules-download-mode: readonly
  allow-parallel-runners: true

linters:
  enable:
    - errcheck
    - govet
    - ineffassign
    - staticcheck
    - unused
    - bodyclose
    - contextcheck
    - copyloopvar
    - errchkjson
    - errorlint
    - gocritic
    - misspell
    - sqlclosecheck
    - unconvert
    - wastedassign
    - lll

  disable:
    - containedctx       
    - dogsled            
    - forcetypeassert  
    - funlen             
    - gochecknoglobals   
    - gochecknoinits    
    - gocognit           
    - gocyclo           
    - godot             
    - godox             
    - mnd              
    - nlreturn          
    - paralleltest    
    - perfsprint 
    - revive             
    - tagalign           
    - tagliatelle        
    - testifylint       
    - testpackage        
    - thelper            
    - varnamelen         
    - wrapcheck          
    - wsl_v5             

linters-settings:
  errcheck:
    check-type-assertions: false
    check-blank: false
  gocritic:
    disabled-checks:
      - exitAfterDefer  # В main.go это нормально
  gosec:
    excludes:
      - G101  # Hardcoded credentials в тестах
      - G115  # Integer overflow conversion - мы проверяем значения

issues:
  exclude-use-default: false
  max-issues-per-linter: 0
  max-same-issues: 0
  
  exclude-rules:
    # Исключаем swagger сгенерированные файлы
    - path: docs/
      linters:
        - gochecknoglobals
        - gochecknoinits
        - godot
    
    # Исключаем main.go от некоторых проверок
    - path: cmd/
      linters:
        - gocritic
    
    # Длинные строки в конфиге
    - path: internal/config/config\.go
      linters:
        - lll